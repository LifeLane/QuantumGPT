// This file is generated by Firebase Genkit.
'use server';

/**
 * @fileOverview AI Trading Strategy Suggestion flow.
 *
 * - suggestTradingStrategy - A function that suggests a trading strategy for a given cryptocurrency.
 * - SuggestTradingStrategyInput - The input type for the suggestTradingStrategy function.
 * - SuggestTradingStrategyOutput - The return type for the suggestTradingStrategy function.
 */

import {ai} from '@/ai/genkit';
import {z} from 'genkit';

const SuggestTradingStrategyInputSchema = z.object({
  cryptocurrency: z.string().describe('The ticker symbol of the cryptocurrency to analyze (e.g., BTC).'),
  riskTolerance: z.enum(['low', 'medium', 'high']).describe('The user\'s risk tolerance level.'),
});
export type SuggestTradingStrategyInput = z.infer<typeof SuggestTradingStrategyInputSchema>;

const SuggestTradingStrategyOutputSchema = z.object({
  strategyExplanation: z.string().describe('A detailed explanation of the suggested trading strategy.'),
  entryPoint: z.number().describe('The suggested entry point for the trade.'),
  exitPoint: z.number().describe('The suggested exit point for the trade.'),
  stopLossLevel: z.number().describe('The suggested stop-loss level for the trade.'),
  profitTarget: z.number().describe('The profit target for the trade.'),
  disclaimer: z
    .string()
    .describe(
      'A disclaimer emphasizing the risks involved in trading and the importance of consulting a financial expert.'
    ),
});
export type SuggestTradingStrategyOutput = z.infer<typeof SuggestTradingStrategyOutputSchema>;

export async function suggestTradingStrategy(input: SuggestTradingStrategyInput): Promise<SuggestTradingStrategyOutput> {
  return suggestTradingStrategyFlow(input);
}

const prompt = ai.definePrompt({
  name: 'suggestTradingStrategyPrompt',
  input: {schema: SuggestTradingStrategyInputSchema},
  output: {schema: SuggestTradingStrategyOutputSchema},
  prompt: `You are an AI-powered trading strategy advisor.

You will suggest an optimal trading strategy for the selected cryptocurrency based on historical data, current market trends, and user-defined risk tolerance.

Cryptocurrency: {{{cryptocurrency}}}
Risk Tolerance: {{{riskTolerance}}}

Consider the following:
- Historical price data and chart patterns
- Current market trends and news sentiment
- User's risk tolerance (low, medium, high)

Provide the following:
- Strategy Explanation: A clear and concise explanation of the suggested strategy.
- Entry Point: The recommended price to enter the trade.
- Exit Point: The recommended price to exit the trade.
- Stop-Loss Level: The price level at which to set a stop-loss order.
- Profit Target: The price level at which to take profit.
- Disclaimer: A standard disclaimer about the risks of trading.

Format your response as a JSON object with the fields: strategyExplanation, entryPoint, exitPoint, stopLossLevel, profitTarget, and disclaimer.
`,
});

const suggestTradingStrategyFlow = ai.defineFlow(
  {
    name: 'suggestTradingStrategyFlow',
    inputSchema: SuggestTradingStrategyInputSchema,
    outputSchema: SuggestTradingStrategyOutputSchema,
  },
  async input => {
    const {output} = await prompt(input);
    return output!;
  }
);
